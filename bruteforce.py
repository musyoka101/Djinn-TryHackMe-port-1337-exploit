#!/bin/env python
import socket
import re
import sys
from datetime import datetime

print ("Time Started: " + str(datetime.now().strftime("%H:%M:%S")) + "\n")
class bcolors:
    OKBLUE = '\033[94m'
    OKGREEN = '\033[92m'
    FAIL = '\033[91m'
    WARNING = '\033[93m'
    ORANGE='\033[33m'
    darkgrey='\033[37m'
    ENDC = '\033[0m'

try:
	#Declaring Host (IP address and port to be used)
	host = sys.argv[1]
	port = 1337

	#creating socket conection IPV4 and TCP Port
	client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	client_socket.connect((host, port))
	# since the  we have to answer the question correctly we do it 1000 times that's why the loop
	for i in range(1001):
		print (bcolors.OKGREEN + "[+] You are in question number {number}".format(number=i) + bcolors.ENDC)
		banner = client_socket.recv(1024)
		banner += client_socket.recv(1024)
		#searching for the calculation
		problem = re.search("\((.*?)\)\x0a>", banner).group(1)
		ex = re.sub ("'", "" , problem)
		ex = re.sub (",", "", ex)
		print (bcolors.OKGREEN + "[+] This is the math calculation we need to do ===> " + ex + bcolors.ENDC)
		#calculate the problem using eval function in python
		result = eval(ex)
		print (bcolors.OKGREEN + "[+] This is the result ===> " + str(result) + bcolors.ENDC)
		print (bcolors.WARNING + "[+] Sending result........." + bcolors.ENDC)
		client_socket.send(str(result) + "\n")
		print
	gift = client_socket.recv(1024)
	print (bcolors.WARNING + gift + bcolors.ENDC)
	print ("Time Finished: " + str(datetime.now().strftime("%H:%M:%S")))
	print (bcolors.FAIL + "Goodbye :(" + bcolors.ENDC)
except IndexError:
	print (bcolors.ORANGE + "An Error Occured\n\nUsage:\n\npython bruteforce.py <IP address>\n\n\nExiting......." + bcolors.ENDC)
except KeyboardInterrupt:
	print (bcolors.FAIL + "\n\n[-] KeyboardInterrupt\n\n[-] Exiting......\n\n" + bcolors.ENDC)
